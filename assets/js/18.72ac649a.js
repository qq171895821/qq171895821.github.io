(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{608:function(t,a,s){"use strict";s.r(a);var e=s(0),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("近期在维护一个实验室的项目的时候遇到了不少问题，大致问题就是项目本身原本采用的是前后端打包部署的方式，而我们采用了分离部署的方式，结果是前后端口不一致，产生了许多跨域问题，比如不能发送cookie的session等，导致页面登录状态不能维持。")]),t._v(" "),s("p",[t._v("随后为了了解打包部署研究了一下SpringBoot的静态资源，这里简单记录一下。")]),t._v(" "),s("h4",{attrs:{id:"静态资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#静态资源"}},[t._v("#")]),t._v(" 静态资源")]),t._v(" "),s("p",[t._v("所谓静态资源就是前端生成的js,css,image,html等文件")]),t._v(" "),s("p",[t._v("下面部分转载自简书，Author：lavor")]),t._v(" "),s("h4",{attrs:{id:"springboot的默认静态资源映射"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#springboot的默认静态资源映射"}},[t._v("#")]),t._v(" SpringBoot的默认静态资源映射")]),t._v(" "),s("p",[t._v("默认情况下，我们只需要将静态资源放在一下几个目录中就可以直接通过url在浏览器中访问了。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("/META-INF/resources/")])]),t._v(" "),s("li",[s("code",[t._v("/resources/")])]),t._v(" "),s("li",[s("code",[t._v("/static/")])]),t._v(" "),s("li",[s("code",[t._v("/public/")])])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_1.webp"),alt:"springbootstatic_1"}}),t._v(" "),s("p",[t._v("如果这四个目录中有相同的静态资源文件，那么优先访问哪个目录下面的资源啊？\n静态资源的默认访问优先级："),s("code",[t._v("/META-INF/resources/")]),t._v(">"),s("code",[t._v("/resources/")]),t._v(">"),s("code",[t._v("/static/")]),t._v(">"),s("code",[t._v("/public/")])]),t._v(" "),s("p",[t._v("在四个目录中都放一个static.html的文件，每个html文件中都说明自己所在的目录，访问结果如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_2.webp"),alt:"springbootstatic_2"}}),t._v(" "),s("p",[t._v("SpringBoot关于静态资源的访问涉及到了application.properties中的两个属性：")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token preprocessor property"}},[t._v("# 默认值为 ")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nspring.mvc.static-path-pattern= #这里设置静态资源匹配的url-pattern\n# 默认值为 classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/ \nspring.resources.static-locations= #这里设置要指向的路径，多个使用英文逗号隔开，在前面的优先级高\n")])])])]),s("p",[t._v("此时，我们豁然开朗，知道默认情况下静态资源为什么放在"),s("code",[t._v("/META-INF/resources/")]),t._v("、"),s("code",[t._v("/resources/")]),t._v("、"),s("code",[t._v("/static/")]),t._v("、"),s("code",[t._v("/public/")]),t._v("这四个目录了，还有这四个目录访问的优先级是怎么来的了。")]),t._v(" "),s("p",[t._v("修改静态资源映射的方法：")]),t._v(" "),s("ul",[s("li",[t._v("我们可以修改这两个属性来改变静态资源的映射，比如我们的所有静态资源都在"),s("code",[t._v("mystatic")]),t._v("目录中，并且我们希望访问静态资源的的url都带有"),s("code",[t._v("/mystatic/")]),t._v("这个目录前缀:")])]),t._v(" "),s("div",{staticClass:"language-cpp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[t._v("spring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mvc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pattern"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mystatic"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nspring.resources.static-locations= classpath:mystatic/\n")])])])]),s("p",[t._v("在"),s("code",[t._v("resources")]),t._v("资源目录中创建一个"),s("code",[t._v("mystatic")]),t._v("目录，在该目录下面创建一个"),s("code",[t._v("static.html")]),t._v("文件，访问结果如下：")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_3.webp"),alt:"springbootstatic_3"}}),t._v(" "),s("ul",[s("li",[s("p",[t._v("继承")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("WebMvcConfigurerAdapter\n")])])]),s("p",[t._v("类，并且重写")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("addResourceHandlers\n")])])]),s("p",[t._v("方法就行，该操作与上面的方法得到的效果是一样的")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_4.webp"),alt:"springbootstatic_4"}})])]),t._v(" "),s("p",[s("strong",[t._v("注意：还可以设置外部磁盘目录，设置方式不变，格式如下："),s("code",[t._v("file:d/mystatic/")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"webjars"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webjars"}},[t._v("#")]),t._v(" WebJars")]),t._v(" "),s("hr"),t._v(" "),s("p",[s("code",[t._v("WebJars")]),t._v("将前端资源（css,js,image,html等等）打包到jar中，然后使用基于"),s("code",[t._v("JVM")]),t._v("的包管理器（比如 "),s("code",[t._v("Maven")]),t._v("、"),s("code",[t._v("Gradle")]),t._v(" 等）管理前端依赖的方案。SpringBoot中也可以通过WebJars来访问静态资源。\nSpringBoot默认将"),s("code",[t._v("/webjars/**")]),t._v("映射到 "),s("code",[t._v("classpath:/META-INF/resources/webjars/")]),t._v("。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("/webjars/**")]),t._v("：表示"),s("code",[t._v("/webjars/")]),t._v("目录下的所有文件，及存在其目录下的jar包中的所有文件。")])]),t._v(" "),s("p",[t._v("所以默认情况下我们需要访问"),s("code",[t._v("WebJars")]),t._v("中的资源，需要将其jar包放到"),s("code",[t._v("classpath:/META-INF/resources/webjars/")]),t._v("目录中。\n我们来使用一下"),s("code",[t._v("WebJars")]),t._v(":")]),t._v(" "),s("ul",[s("li",[t._v("在"),s("code",[t._v("pom.xml")]),t._v("中引入"),s("code",[t._v("jquery")]),t._v("的"),s("code",[t._v("WebJars")]),t._v("，默认会被放在"),s("code",[t._v("classpath:/META-INF/resources/webjars/")]),t._v("目录中")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.webjars"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("jquery"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2.1.1"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("在前端"),s("code",[t._v("webjars.html")]),t._v("页面中引入"),s("code",[t._v("jquery")])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/webjars/jquery/2.1.1/jquery.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("访问页面")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("webjars.html\n")])])]),s("p",[t._v("，查看源码，可以链接到")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jquery.js\n")])])]),s("p",[t._v("的内容")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_5.webp"),alt:"springbootstatic_5"}})])]),t._v(" "),s("h4",{attrs:{id:"版本号统一管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本号统一管理"}},[t._v("#")]),t._v(" 版本号统一管理")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("如果我们有很多页面都是用了"),s("code",[t._v("WebJars")]),t._v("中的资源，而我们现在要升级"),s("code",[t._v("WebJars")]),t._v("的版本，岂不是要在每个页面中都改动一下，这样很麻烦啊，有没有简单的方法啊。此时，我们可以进行版本号统一管理。")]),t._v(" "),s("ul",[s("li",[t._v("在"),s("code",[t._v("pom.xml")]),t._v("中引入"),s("code",[t._v("jquery")]),t._v("的"),s("code",[t._v("WebJars")]),t._v("的基础上添加：")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[t._v("        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.webjars"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("webjars-locator"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("添加版本号统一管理的控制器")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/Springbootstatic_6.webp"),alt:"Springbootstatic_6"}})]),t._v(" "),s("li",[s("p",[t._v("在页面中引入"),s("code",[t._v("jquery")]),t._v("的方式如下：")])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/webjarslocator/jquery/jquery.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h2",{attrs:{id:"静态资源版本管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#静态资源版本管理"}},[t._v("#")]),t._v(" 静态资源版本管理")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("当我们资源内容发生变化时，由于浏览器缓存，用户本地的静态资源还是旧的资源，为了防止这种情况导致的问题，我们可能会手动在请求url的时候加个版本号或者其他方式。")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lavor.js?v=1.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("SpringMVC提供了两种方式可以帮助我们很容易地解决这类问题。")]),t._v(" "),s("h3",{attrs:{id:"md5方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#md5方式"}},[t._v("#")]),t._v(" MD5方式")]),t._v(" "),s("hr"),t._v(" "),s("ul",[s("li",[t._v("修改"),s("code",[t._v("application.properties")]),t._v("配置文件")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("spring.resources.chain.strategy.content.enabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\nspring.resources.chain.strategy.content.paths"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/**\n")])])]),s("ul",[s("li",[s("p",[t._v("添加")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("@ControllerAdvice\n")])])]),s("p",[t._v("注解，返回")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ResourceUrlProvider\n")])])]),s("p",[t._v("的对象，这样所有通过控制器返回的模板页面（jsp,thymeleaf,freeemarker等）就都可以在页面中使用该对象了")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_7.webp"),alt:"springbootstatic_7"}})]),t._v(" "),s("li",[s("p",[t._v("在控制器返回的模板页面中，添加以下信息，我们这里的返回页面时jsp页面，"),s("code",[t._v("lavor.js")]),t._v("是"),s("code",[t._v("webapp")]),t._v("目录下面的js脚本文件。")])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("${urls.getForLookupPath("),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("/lavor.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(") }"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("通过浏览器访问控制器的请求url，查看页面源代码")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lavor-fdfa0502716d517c6cad4f2536aa02a1.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("请求"),s("code",[t._v("/lavor-fdfa0502716d517c6cad4f2536aa02a1.js")]),t._v("，我们MD5配置的"),s("code",[t._v("paths=/**")]),t._v("，所以SpringMVC会尝试url中是否包含"),s("code",[t._v("-")]),t._v("，如果包含会去掉后面这部分，然后去映射的目录（如webapp根目录，上面提到的四大静态映射目录）查找"),s("code",[t._v("/lavor.js")]),t._v("文件，如果能找到就返回。")]),t._v(" "),s("h3",{attrs:{id:"版本号方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本号方式"}},[t._v("#")]),t._v(" 版本号方式")]),t._v(" "),s("hr"),t._v(" "),s("ul",[s("li",[t._v("修改"),s("code",[t._v("application.properties")]),t._v("配置文件，"),s("strong",[t._v("注意MD5方式中的是"),s("code",[t._v("content")]),t._v("，这里是"),s("code",[t._v("fixed")])])])]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[t._v("spring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resources"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strategy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fixed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token preprocessor property"}},[t._v("#版本号处理的路径")]),t._v("\nspring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resources"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strategy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fixed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("paths"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n# 版本号，可以为所处理路径中的资源加上/v1.1目录前缀\nspring.resources.chain.strategy.fixed.version=v1.1\n")])])])]),s("ul",[s("li",[s("p",[t._v("添加")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("@ControllerAdvice\n")])])]),s("p",[t._v("注解，返回")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ResourceUrlProvider\n")])])]),s("p",[t._v("的对象，这样所有通过控制器返回的模板页面（jsp,thymeleaf,freeemarker等）就都可以在页面中使用该对象了")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/images/springbootstatic_7.webp"),alt:"springbootstatic_7"}})]),t._v(" "),s("li",[s("p",[t._v("在控制器返回的模板页面中，添加以下信息，我们这里的返回页面时jsp页面，"),s("code",[t._v("lavor.js")]),t._v("是"),s("code",[t._v("webapp")]),t._v("目录下面的js脚本文件.")])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("${urls.getForLookupPath("),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("/lavor.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(") }"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("通过浏览器访问控制器的请求url，查看页面源代码")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/v1.1/lavor.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("请求"),s("code",[t._v("/v1.1/lavor.js")]),t._v("，会查看"),s("code",[t._v("v1.1")]),t._v("是不是版本号，如果是就去掉前缀目录，直接查找"),s("code",[t._v("/lavor.js")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("注意：我们发现如果添加了webapp目录，那么该目录也可以存放静态资源，并且默认情况下访问优先级比"),s("code",[t._v("/META-INF/resources/")]),t._v("还要高。")])])])}),[],!1,null,null,null);a.default=r.exports}}]);